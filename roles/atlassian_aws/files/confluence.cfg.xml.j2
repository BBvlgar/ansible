<?xml version="1.0" encoding="UTF-8"?>

<confluence-configuration>

  <setupStep>setupstart</setupStep>
  <setupType>custom</setupType>
  <buildNumber>0</buildNumber>

  <properties>
    <property name="confluence.database.choice">postgresql</property>
    <property name="confluence.database.connection.type">database-type-standard</property>
    <property name="hibernate.dialect">com.atlassian.confluence.impl.hibernate.dialect.PostgreSQLDialect</property>
    <property name="webwork.multipart.saveDir">${localHome}/temp</property>
    <property name="attachments.dir">${confluenceHome}/attachments</property>

    <property name="hibernate.connection.driver_class">org.postgresql.Driver</property>
    <property name="hibernate.connection.url">jdbc:postgresql://{{ atl_db_host }}/{{ atl_jdbc_db_name }}{% if atl_jdbc_query_params|length %}?{{ atl_jdbc_query_params }}{% endif %}</property>
    <property name="hibernate.connection.username">{{ atl_jdbc_user }}</property>
    <property name="hibernate.connection.password">{{ atl_jdbc_password | replace("&", "&amp;") }}</property>
    
    <property name="hibernate.c3p0.acquire_increment">1</property>
    <property name="hibernate.c3p0.idle_test_period">100</property>
    <property name="hibernate.c3p0.max_size">60</property>
    <property name="hibernate.c3p0.max_statements">0</property>
    <property name="hibernate.c3p0.min_size">20</property>
    <property name="hibernate.c3p0.preferredTestQuery">select 1</property>
    <property name="hibernate.c3p0.timeout">30</property>
    <property name="hibernate.c3p0.validate">false</property>

    <property name="shared-home">/shared</property>
    <property name="confluence.cluster">true</property>
    <property name="confluence.cluster.home">/shared</property>
    <property name="confluence.cluster.aws.iam.role">{{ atl_hazelcast_network_aws_iam_role }}</property>
    <property name="confluence.cluster.aws.region">eu-central-1</property>
    <property name="confluence.cluster.aws.host.header">ec2.amazonaws.com</property>
    <property name="confluence.cluster.aws.tag.key">{{ atl_hazelcast_network_aws_tag_key }}</property>
    <property name="confluence.cluster.aws.tag.value">{{ atl_hazelcast_network_aws_tag_value }}</property>
    <property name="confluence.cluster.join.type">aws</property>
    <property name="confluence.cluster.name">{{ atl_aws_stack_name }}</property>
    <property name="confluence.cluster.ttl">1</property>

  </properties>
</confluence-configuration>
